---
title: "lista_1"
format: html
editor: visual
---

# Exercício sobre parte 1 - Forecasting

## Bibliotecas

Importando Pacotes utilizados neste documento.

```{r}
library(fpp3)
library(tseries)
```

## Importando Base de Dados

Para a resolução dos exercícios, será utilizada a base de dados **aus_retail**, que consiste em dados sobre as vendas no varejo australiano, uma série temporal mensal de diferentes categorias de varejo.

Abaixo esta listada todas as categorias presentes na base de dados:

```{r}
unique(aus_retail$Industry)
```

Para realizar o trabalho iremos utilizar a categoria de "Department stores":

```{r}
# Realizando Filtro
department_stores_data <- aus_retail %>%
  filter(Industry == "Department stores")
```

Estes dados referem-se a lojas de departamentos, que são grandes estabelecimentos de varejo que oferem uma ampra variedade de mercadorias em diferentes seções ou departamentos dentro da mesma loja.

## Pre-Precessamento

Da forma que o dataframe está organizado, existem diferentes estados:

```{r}
unique(department_stores_data$State)
```

Para a resolução dos exercícios da lista, serão utilizados os dados da Austrália inteira, sendo necessária a seguinte transformação:

```{r}
department_stores_group <- department_stores_data %>%
  index_by(Month) %>%
  summarise(Turnover_total = sum(Turnover, na.rm = TRUE))
```

Com esta transformação, os dados são agrupados pela coluna "Month", somando os turnovers de todos os estados conforme essa coluna. O resultado final é a receita total de lojas de departamentos para toda a Austrália.

## Resolução:

### Questão 1

**Plote os gráficos da série e das ACF/PACF e discorra sobre o aspecto da série. Faça o teste de raíz unitária e explique as conclusões. Existe tendência estocástica?**

O primeiro gráfico análisado será o Time Plot:

```{r}
department_stores_group %>%
  autoplot(Turnover_total) +
  labs(y="Turnover", title="Australian Department Stores Turnover")
```

O gráfico plotado acima demonstra um aparente padrão sazonal na série, com um pico de receita que se repete ao longo dos anos. Além disso, parece haver uma tendência de aumento de receita ao longo da série.

Outro gráfico analisado será o Seasonal Plot:

```{r}
department_stores_group %>%
  gg_season(Turnover_total, period = "year")
```

Observando o gráfico plotado, é possível identificar um padrão sazonal de aumento de vendas no mês de dezembro, representado pelo pico no gráfico. Além disso, após esse pico de vendas, há uma queda aparente em fevereiro, que se mostra mais acentuada nos anos mais recentes.

Para uma melhor compreensão sobre a possível tendência de aumento de receita ao longo dos anos, podemos observar o gráfico de subplots abaixo:

```{r}
department_stores_group %>%
  gg_subseries(Turnover_total)
```

Como podemos observar pelo gráfico discriminado por meses acima, a sazonalidade de aumento de vendas em dezembro está bem representada. Além disso, nota-se que, de maneira geral, houve um aparente aumento acentuado de receita em todos os meses entre os anos de 1990 e o início dos anos 2000, estabilizando-se nos anos seguintes.

Para reforçar essas premissas, podemos analisar as funções de autocorrelação e autocorrelação parcial.

```{r}
# Gráfico de Autocorrelação
department_stores_group %>%
  ACF(Turnover_total, lag_max = 100) %>%
  autoplot()
```

Como esperado, a função de autocorrelação revela fortes correlações entre os lags múltiplos de 12 (12, 24, 36\...) indicando a sazonalidade associada aos meses de dezembro. Além disso, é possível observar uma aparente tendência positiva, evidenciada pela significativa autocorrelação nos lags menores, que diminui gradualmente à medida que os lags aumentam.

```{r}
# Gráfico de Autocorrelação Parcial
department_stores_group %>%
  PACF(Turnover_total, lag_max = 100) %>%
  autoplot()
```

Analisando o gráfico gerado pela PACF, percebemos um pico positivo seguido por um pico negativo, ambos muito acima das bandas do intervalo de confiança, nos lags 12 e 13. Isso indica uma forte sazonalidade neste período do ano, conforme observado nos gráficos anteriores.

Ao que tudo indica, esta série temporal possui raiz unitária e não é estacionária. Para obtermos mais uma medida que confirme esta hipótese, podemos realizar o teste de raiz unitária de Dickey-Fuller abaixo:

```{r}
# Realizar o teste ADF
adf_result <- adf.test(department_stores_group$Turnover_total, alternative = "stationary")

adf_result
```

Como o p-valor é menor do que 0.01

### Questão 2

**Use um método de decomposição estudado e explique os componentes, tendo em vista o aspecto da série. Existe sazonalidade? Qual periodicidade?**

Aplicando método de decomposição dos componentes:

```{r}
department_stores_group %>%
  model(
    classical_decomposition(Turnover_total, type = "additive")
  ) |>
  components() |>
  autoplot() +
  labs(title = "Decomposição Série Departaments Stores")
```

Como podemos observar no gráfico de decomposição, existe um padrão sazonal de picos de venda no final de cada ano da série, fenômeno que já podia ser observado nos gráficos gerados anteriormente.

Ao contrário do resultado do teste ADF realizado na questão anterior, a decomposição da série temporal sugere a presença de uma tendência positiva de aumento nas vendas ao longo dos anos, o que também pode ser observado nos gráficos ACF. Este fato indica que a série pode não ser completamente estacionária, possuindo uma tendência subjacente que não foi completamente capturada pelo teste ADF. Isso pode ser caracterizado como um caso de estacionaridade fraca, onde a tendência implica em uma diferença na média e variância que não foi considerada estatisticamente relevante pelo teste ADF.

### Questão 3

**Identifique um modelo SARIMA apropriado. Justifique o modelo escolhido através de critérios de informação e/ou usando a etapa de identificação da abordagem Box-Jenkins. Nesta etapa é possível utilizar um método automático de seleção das ordens do modelo.**

```{r}
write.csv(department_stores_group, "department_store.csv", row.names = FALSE)
```
